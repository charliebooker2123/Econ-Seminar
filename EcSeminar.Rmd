---
title: "Econ Seminar"
author: "Charlie Booker"
date: "May 5, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plyr)
library(knitr)
library(fs)
library(graphics)
#this library needed to read in excel
library(readxl)
#these libraries will be needed to plot map
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
library(janitor)
library(kableExtra)
library(dplyr)
library(mapproj)
```

```{r}
#loading in data
patents <- read_excel("Patent_County.xlsx", skip = 1)

#gini coefficient
GC2006 <- read.csv("GC2006-2010.csv")
GC2011 <- read.csv("GC2011-2015.csv")

#per capita income
PCI2006 <- read.csv("PCI2006.csv")
PCI2011 <- read.csv("PCI2010.csv")

#Race
Race2006 <- read.csv("Race2006.csv")
Race2011 <- read.csv("Race2010.csv")

#Education by Sex
Education2006 <- read.csv("EducationSex2006.csv")
Education2011 <- read.csv("EducationSex2010.csv")

#county coordinate data
coordinates <- read_xlsx('County Coordinates.xlsx', skip = 1)

```

```{r}
#editng the data sets
#trimming out unnecessary columns
```


```{r}
#Gini Coefficients edits
#selecting and getting rid of columns
GC2006 <- GC2006 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:J4TM001)

GC2011 <- GC2011 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:AD4BM001)

#renaming Gini Coefficient Columns
GC2006 <- GC2006 %>%
  rename(c("J4TE001" = "GC_Estimate", "J4TM001" = "GC_Margin_of_Error"))

GC2011 <- GC2011 %>% 
  rename(c("AD4BE001" = "GC_Estimate", "AD4BM001" = "GC_Margin_of_Error"))
```

```{r}
#per capita income edits
#selecting and getting rid of columns
PCI2006 <- PCI2006 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:JQBM001)

PCI2011 <- PCI2011 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:ADOLM001)

#renaming per capita income
PCI2006 <- PCI2006 %>%
  rename(c("JQBE001" = "PCI_Estimate", "JQBM001" = "PCI_Margin_of_Error"))

PCI2011 <- PCI2011 %>%
  rename(c("ADOLE001" = "PCI_Estimate", "ADOLM001" = "PCI_Margin_of_Error"))
```

```{r}
#Race edits
#selecting and getting rid of columns
Race2006 <- Race2006 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:JMBM010)

Race2011 <- Race2011 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:ADKXM010)

#renaming race
Race2006 <- Race2006 %>%
  rename(c("JMBE001" = "Total_Population", "JMBE002" = "White", "JMBE003" = "Black", "JMBE004" = "Native_American", "JMBE005" = "Asian", "JMBE006" = "Pacific", "JMBE007" = "Some_Other", "JMBE008" = "Two_or_More", "JMBE009" = "Two_or_More_Some_Other", "JMBE010" = "Three_or_More",
           "JMBM001" = "Total_PopulationErr", "JMBM002" = "WhiteErr", "JMBM003" = "BlackErr", "JMBM004" = "Native_AmericanErr", "JMBM005" = "AsianErr", "JMBM006" = "PacificErr", "JMBM007" = "Some_OtherErr", "JMBM008" = "Two_or_MoreErr", "JMBM009" = "Two_or_More_Some_OtherErr", "JMBM010" = "Three_or_MoreErr"))

Race2011 <- Race2011 %>%
  rename(c("ADKXE001" = "Total_Population", "ADKXE002" = "White", "ADKXE003" = "Black", "ADKXE004" = "Native_American", "ADKXE005" = "Asian", "ADKXE006" = "Pacific", "ADKXE007" = "Some_Other", "ADKXE008" = "Two_or_More", "ADKXE009" = "Two_or_More_Some_Other", "ADKXE010" = "Three_or_More",
           "ADKXM001" = "Total_PopulationErr", "ADKXM002" = "WhiteErr", "ADKXM003" = "BlackErr", "ADKXM004" = "Native_AmericanErr", "ADKXM005" = "AsianErr", "ADKXM006" = "PacificErr", "ADKXM007" = "Some_OtherErr", "ADKXM008" = "Two_or_MoreErr", "ADKXM009" = "Two_or_More_Some_OtherErr", "ADKXM010" = "Three_or_MoreErr"))
```

```{r}
#Education by Sex edits
#selecting and getting rid of columns
Education2006 <- Education2006 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:JN9M035)

Education2011 <- Education2011 %>%
  select(GISJOIN, YEAR, STATE:COUNTYA, NAME_E:ADMYM035)

#renaming Education
Education2006 <- Education2006 %>%
  rename(c("JN9E001" = "Total_Population", "JN9E002" = "MalePop", "JN9E003" = "MNoSchool", "JN9E004" = "M4thGrade", "JN9E005" = "M5thGrade", "JN9E006" = "M7thGrade", "JN9E007" = "M9thGrade", "JN9E008" = "M10thGrade", "JN9E009" = "M11thGrade", "JN9E010" = "M12thGrade", "JN9E011" = "MHighSchoolGrad", "JN9E012" = "MSomeCollege1", "JN9E013" = "MSomeCollege1Plus", "JN9E014" = "MAssociate", "JN9E015" = "MBachelor", "JN9E016" = "MMaster", "JN9E017" = "MProfessional", "JN9E018" = "MDoctorate",
           "JN9E019" = "FemalePop", "JN9E020" = "FNoSchool", "JN9E021" = "F4thGrade", "JN9E022" = "F5thGrade", "JN9E023" = "F7thGrade", "JN9E024" = "F9thGrade", "JN9E025" = "F10thGrade", "JN9E026" = "F11thGrade", "JN9E027" = "F12thGrade", "JN9E028" = "FHighSchoolGrad", "JN9E029" = "FSomeCollege1", "JN9E030" = "FSomeCollege1Plus", "JN9E031" = "FAssociate", "JN9E032" = "FBachelor", "JN9E033" = "FMaster", "JN9E034" = "FProfessional", "JN9E035" = "FDoctorate"))

Education2011 <- Education2011 %>%
  rename(c("ADMYE001" = "Total_Population", "ADMYE002" = "MalePop", "ADMYE003" = "MNoSchool", "ADMYE004" = "M4thGrade", "ADMYE005" = "M5thGrade", "ADMYE006" = "M7thGrade", "ADMYE007" = "M9thGrade", "ADMYE008" = "M10thGrade", "ADMYE009" = "M11thGrade", "ADMYE010" = "M12thGrade", "ADMYE011" = "MHighSchoolGrad", "ADMYE012" = "MSomeCollege1", "ADMYE013" = "MSomeCollege1Plus", "ADMYE014" = "MAssociate", "ADMYE015" = "MBachelor", "ADMYE016" = "MMaster", "ADMYE017" = "MProfessional", "ADMYE018" = "MDoctorate",
           "ADMYE019" = "FemalePop", "ADMYE020" = "FNoSchool", "ADMYE021" = "F4thGrade", "ADMYE022" = "F5thGrade", "ADMYE023" = "F7thGrade", "ADMYE024" = "F9thGrade", "ADMYE025" = "F10thGrade", "ADMYE026" = "F11thGrade", "ADMYE027" = "F12thGrade", "ADMYE028" = "FHighSchoolGrad", "ADMYE029" = "FSomeCollege1", "ADMYE030" = "FSomeCollege1Plus", "ADMYE031" = "FAssociate", "ADMYE032" = "FBachelor", "ADMYE033" = "FMaster", "ADMYE034" = "FProfessional", "ADMYE035" = "FDoctorate"))
```

```{r}
#editing the coordinates data set
#renaming the columns
coordinates <- coordinates %>%
  rename(c("X__1" = "Sort", "X__2" = "State", "X__3" = "FIPS", "X__4" = "County", "X__5" = "CountySeats", "-2010" = "Population", "Longitude1" = "Longitude", "Latitude1" = "Latitude"))

#getting rid of unneeded columns 
coordinates <- coordinates %>%
  select(Sort, State, FIPS, County, Population, Longitude, Latitude)
  
```

```{r}
#capitalizing the state name so I can merge by state name
Education2006[,3] = toupper(Education2006[,3])
```

```{r}
#renaming a few patent variables, preparing for easier merger by changing FIPS name
patents <- patents %>%
  rename(c('Regional Area Component' = "County", 'FIPS Code' = "FIPS"))
```

```{r}
patents$CountyNew1 <-
gsub("\\s*\\([^\\)]+\\)","",as.character(patents$County))

patents$County <- patents$CountyNew1
```


```{r}
#library(tm)

#stopwords = c("[()]", "", "city")
#stopwords = readLines('stopwords.txt')
#x = patents$County
#x = removeWords(x,stopwords)

#patents$County_new <- x

#patents <-  patents %>%
  #str_remove_all("(city)")
```

```{r}
#first merger with coordinates and patents

pat_coord <- inner_join(patents, coordinates, by = "FIPS")
```

